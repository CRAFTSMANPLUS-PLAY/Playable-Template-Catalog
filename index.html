<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>CRAFTSMAN+ PLAY • Template Catalog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root {
        --bg: #101013;
        --surface: #1a1c21;
        --text: #fff;
        --muted: rgba(255, 255, 255, 0.56);
        --blue: #007aff;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        background: var(--bg);
        color: var(--text);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      }

      .wrap {
        max-width: 1150px;
        margin: 0 auto;
        padding: 26px 20px 70px;
      }

      header {
        display: flex;
        gap: 16px;
        align-items: center;
        margin-bottom: 26px;
      }

      .brand-logo {
        height: 44px;
        width: auto;
      }

      h1 {
        display: flex;
        gap: 10px;
        align-items: center;
        margin: 0 0 4px 0;
        font-size: 1.1rem;
        letter-spacing: 0.02em;
      }

      .pill {
        background: rgba(255, 255, 255, 0.04);
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 0.62rem;
      }

      .tagline {
        font-size: 0.7rem;
        color: var(--muted);
      }

      .error-bar {
        background: #3b1212;
        border: 1px solid rgba(255, 92, 92, 0.4);
        border-radius: 12px;
        padding: 12px 14px;
        font-size: 0.72rem;
        margin-bottom: 20px;
        display: none;
      }

      .section {
        margin-bottom: 40px;
      }

      .section-title {
        font-size: 0.65rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        color: rgba(255, 255, 255, 0.55);
        margin-bottom: 14px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .section-title small {
        font-size: 0.6rem;
        color: rgba(255, 255, 255, 0.3);
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 22px;
        justify-items: center;
      }

      .card {
        width: 260px;
        background: var(--surface);
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.05);
        display: flex;
        flex-direction: column;
      }

      .thumb {
        width: 100%;
        aspect-ratio: 9 / 16; /* Portrait ratio */
        background: rgba(255, 255, 255, 0.04);
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .thumb img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .play-btn {
        position: absolute;
        bottom: 12px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--blue);
        color: #fff;
        border: none;
        border-radius: 999px;
        padding: 8px 14px;
        font-size: 0.68rem;
        font-weight: 600;
        cursor: pointer;
      }

      .card-footer {
        padding: 10px 14px 14px;
      }

      .card-title {
        font-size: 0.78rem;
        font-weight: 600;
      }

      .card-cat {
        font-size: 0.62rem;
        color: var(--muted);
      }

      @media (max-width: 720px) {
        header {
          flex-wrap: wrap;
        }
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <img
          src="./CraftsmanPlay-Light.png"
          alt="CRAFTSMAN+ Logo"
          class="brand-logo"
        />
        <div>
          <h1>
            <span>CRAFTSMAN+ PLAY</span>
            <span class="pill">Template Catalog</span>
            <span class="pill">For Partners</span>
          </h1>
          <div class="tagline">
            Browse core interactive ad formats. Click "Play Now" to open and try
            live.
          </div>
        </div>
      </header>

      <div id="error" class="error-bar"></div>
      <div id="sections"></div>
    </div>

    <script>
  const JSON_URL = "./Playable_Endpoint_URLs.json";
  const errorBar = document.getElementById("error");
  const sectionsRoot = document.getElementById("sections");

  function createCard(item) {
    const card = document.createElement("div");
    card.className = "card";

    const thumb = document.createElement("div");
    thumb.className = "thumb";

    const img = document.createElement("img");

    // ✅ FIX: encode file names that have spaces or special characters
    if (item.poster) {
      const encoded = encodeURIComponent(item.poster);
      img.src = "./" + encoded;
    } else {
      img.src = "https://dummyimage.com/260x480/1a1c21/ffffff&text=No+Preview";
    }

    img.alt = item.name || "Playable Preview";

    const playBtn = document.createElement("button");
    playBtn.className = "play-btn";
    playBtn.textContent = "PLAY NOW ▶";
    playBtn.addEventListener("click", () => {
      if (item.url) window.open(item.url, "_blank", "noopener");
    });

    thumb.appendChild(img);
    thumb.appendChild(playBtn);

    const footer = document.createElement("div");
    footer.className = "card-footer";

    const title = document.createElement("div");
    title.className = "card-title";
    title.textContent = item.name || "Untitled";

    const cat = document.createElement("div");
    cat.className = "card-cat";
    cat.textContent = item.category || "Other";

    footer.appendChild(title);
    footer.appendChild(cat);

    card.appendChild(thumb);
    card.appendChild(footer);

    return card;
  }

  async function init() {
    try {
      const res = await fetch(JSON_URL + "?t=" + Date.now());
      if (!res.ok) throw new Error("HTTP " + res.status);
      const data = await res.json();

      const items = Array.isArray(data)
        ? data
        : Array.isArray(data.playables)
        ? data.playables
        : [];

      const buckets = {};
      items.forEach((it) => {
        const cat = (it.category || "Other").trim();
        if (!buckets[cat]) buckets[cat] = [];
        buckets[cat].push(it);
      });

      const orderedCats = Object.keys(buckets).sort((a, b) =>
        a.localeCompare(b)
      );

      orderedCats.forEach((cat) => {
        const section = document.createElement("div");
        section.className = "section";

        const title = document.createElement("div");
        title.className = "section-title";
        title.textContent = cat.toUpperCase();

        const count = document.createElement("small");
        count.textContent = "• " + buckets[cat].length + " demos";
        title.appendChild(count);

        const grid = document.createElement("div");
        grid.className = "grid";

        buckets[cat].forEach((item) => {
          grid.appendChild(createCard(item));
        });

        section.appendChild(title);
        section.appendChild(grid);

        sectionsRoot.appendChild(section);
      });
    } catch (err) {
      console.error(err);
      errorBar.style.display = "block";
      errorBar.textContent =
        "Could not load JSON file. Check filename & path. " + err.message;
    }
  }

  init();
    </script>
  </body>
</html>
